
펌웨어 개발은 크게 **빌드(Build)** 과정과 **다운로드(Download)** 과정으로 나뉜다.

- **Build**: 소스 코드를 작성하고, 이를 마이크로컨트롤러(MCU)가 이해할 수 있는 기계어 파일로 변환하는 모든 과정. (1 ~ 4단계)
- **Download**: 빌드 완료된 파일을 MCU의 메모리에 쓰는 과정. (5단계)

# 1. 소스 코드 작성

C/C++, Rust와 같은 고급 언어로 펌웨어의 동작 로직을 설계하고 구현하는 단계. 사람이 이해하기 쉬운 언어로 하드웨어를 어떻게 제어할지, 어떤 기능을 수행할지, 어떤 순서로 작동할지를 구체적으로 작성한다.

- 주요 작업:
    - MCU의 특정 기능(GPIO, UART, I2C, 타이머 등)을 제어하는 코드 작성
    - 데이터 처리 및 알고리즘 구현
    - 전체 시스템의 동작 시나리오 설계
- 입력: 개발자의 아이디어, 하드웨어 사양서(Datasheet)
- 출력: 소스 파일 및 헤더 퍼일(`.c`, `.h`)

# 2. Cpompilation

사람이 작성한 C언어와 같은 고급 언어를 컴퓨터가 좀 더 이해하기 쉬운 어셈블리어로 번역하는 과정이다. Compiler가 이를 수행한다.

1. 전처리 (Preprocessing): `#include`, `#define` 같은 전처리기 지시문을 먼저 처리한다.
2. 컴파일 (Compilation): 정리된 소스 코드의 문법이 맞는지 검사하고, 오류가 없으면 최적화 과정을 거쳐 해당 MCU에 맞는 어셈블리 코드로 변환한다.

- 입력: 소스 파일 (`.c`, `.h`)
- 도구: 컴파일러 (gcc, clang)
- 출력: 어셈블리 파일 (`.s` 또는 `.asm`)

# Assembly

어셈블리어를 CPU가 직접 해독할 수 있는 **기계어**로 변환한다. 어셈블리어 명령어 하나하나를 그에 대응하는 이진 코드로 바꾼다.

- 입력: 어셈블리 파일(`.s`)
- 출력: 오브젝트 파일(`.o`) 이 파일은 기계어로 이뤄져 있지만, 아직 여러 파일에 흩어져 있는 코드와 데이터의 최종 주소가 확정되지 않은 '미완성' 상태이다. 각 소스 파일(`.c`)이 각각의 오브젝트 파일(`.o`)로 변환된다.

# Linking

링커(Linker)가 여러 개로 흩어져 있는 **오브젝트 파일들(`*.o`)** 과 **라이브러리 파일들(`.a`, `.lib`)** 을 하나로 합쳐서, 최종적으로 실행 가능한 하나의 파일을 만드는 과정이다.

1. 주소 결정 (Relocation): **링커 스크립트(`.ld`)** 를 참조하여 각 코드와 변수들이 메모리(Flash, RAM)의 어느 주소에 위치할 지 최종적으로 결정하고 배치한다. 펌웨어에서 이 과정은 매우 중요하다.
2. 심볼 해석 (Symbol Resolution): `A.c` 파일에서 사용한 `B.c` 파일의 함수나 변수를 서로 연결해준다. 예를 들어, `main.c`에서 `led_on()` 함수를 호출했다면, `led.o` 파일에 있는 `led_on()` 함수의 실제 위치를 찾아 연결해주는 작업을 한다.

- 입력: 여러 개의 오브젝트 파일 (`.o`), 라이브러리 파일(`.a`), 링커 스크립트 (`.ld`)
- 도구: 링커 (ex. ld)
- 출력: 하나의 **실행 파일**. 이 파일은 MCU에 올릴 준비가 된 완전한 펌웨어 이미지이다. 확장자는 `.elf`, `.hex`, `.bin` 등 다양하다.
    - **.elf**: 디버깅 정보가 포함된 포괄적인 파일
    - **.hex, .bin**: 실제 메모리에 기록될 순수 기계어 데이터만 담긴 파일

# Flashing / Download

링크 단계를 거쳐 **최종 실행 파일**을 PC에서 타겟 보드의 **Flash Memory**로 전송하여 기록하는 과정이다. 플래시 메모리는 비휘발성이라 전원이 꺼져도 내용이 지워지지 않는다.

- 입력: 실행 파일 (`.hex` 또는 `.bin`)
- 도구:
    - 하드웨어: 디버거 장비 (ex. ST-LINK, J-Link)
    - 소프트웨어: 플래싱 프로그램 (ex. STM32CubrProgrammer, J-Flash, OpenOCD)
- 출력: 펌웨어가 MCU에 기록되어, 전원이 인가되면 즉시 실행될 수 있는 상태가 된다.